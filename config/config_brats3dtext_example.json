{
    "name": "BraTS3D_Text_depth4_s16_SGD_fp16_continue0.1_imgproj",
    "n_gpu": 4,

    "dataset": {
        "name": "BraTS3DText",
        "path": "/leonardo_work/IscrC_narc2/reports_project/BRATS2023_Training_nifti",
        "report_folder": "report_BraTS-Report_biobert",
        "patch_size": 128,
    
        "grid_overlap": 0,
        "queue_length": 100,
        "samples_per_volume": 2,
        "batch_size": 8,
        "split_file": "/leonardo/home/userexternal/kmarches/Report-Guided-Segmentation/split_files/BraTS23_reports.json",
        "transforms": "/leonardo/home/userexternal/kmarches/Report-Guided-Segmentation/config/brats3d_transforms.json"
    },
    "classes": {
        "0": "Background",
        "1": "Necrosi",
        "2": "Edema",
        "3": "Enhancing Tumor"
    },
    "aggregated_regions": {
        "ET": [3],
        "TC": [1, 3],
        "WT": [1, 2, 3]
    },
    "model": {
        "name": "UNet3DText",
        "in_channels": 4,
        "num_classes": 4,
        "size": 16,
        "depth": 4,
        "text_dim": 768,
        "text_proj": false,
        "img_proj": true, 
        "bias_init": 0
    },
    "loss": {
        "name": "CombinedSegSigLoss",
        "seg_loss_name": "DiceFocalLoss",
        "seg_loss_kwargs": {
            "include_background": false,
            "softmax": true
        },
        "lambda_sig_initial": 0.05,
        "lambda_sig_final": 0.5,
        "lambda_warmup_epochs": 100,
        "lambda_sig": 0.1,
        "sigloss_kwargs": {"mode": 2}
    },
    "optimizer": {
        "name": "AdamW",
        "lr": 0.0005,
        "weight_decay": 0.0001
    },
    "scheduler": {
        "name": "CosineAnnealingLR",
        "T_max": 4270,
        "eta_min": 0.000001
    },
    "metrics": [
        {
            "key": "DSC",
            "name": "DiceMetric",
            "params": { "include_background": false },
            "train": true,
            "val": true,
            "test": true
        },
        {
            "key": "HD95",
            "name": "HausdorffDistanceMetric",
            "params": {"percentile": 95},
            "train": false,
            "val": true,
            "test": true
        }
    ]
}
