{
    "name": "QaTaCOV_textft_64-5_SGD_l0.1-S3-V2-GM1-ClinicalBERT",
    "n_gpu": 1,

    "dataset": {
        "name": "QaTaCovTextEmb",
        "path": "/leonardo_work/IscrC_narc2/reports_project/QaTa-COV19/QaTa-COV19-v2_preprocessed_gt",
        "split_file": "/leonardo_work/IscrC_narc2/reports_project/QaTa-COV19/QaTa-COV19-v2_preprocessed_gt/qatacov_split3.xlsx",
        "text_emb_dir": "/leonardo_work/IscrC_narc2/reports_project/QaTa-COV19/Text_Embeddings/ClinicalBERT",
        "batch_size": 64,
        "image_size": [224, 224],
        "transforms": "config/qatacov2d_transforms.json"
    },
    "pretrained_unet_path": "/leonardo_work/IscrC_narc2/reports_project/trained_models/QaTaCov2D/0_sweep_baselines/baseline_64-5_SGD_S3_A33634707_21/model_best.pth",
    "classes": {
        "0": "Background",
        "1": "Covid"
    },
    "model": {
        "name": "UNet2D",
        "in_channels": 1,
        "num_classes": 2,
        "size": 32,
        "depth": 5
    },
    "trainer": {
        "name": "Trainer_2D_TextGuided",
        "text_emb_dim_in": 768,
        "guidance_mode": 1
    },
    "loss": {
        "name": "CombinedSegSigLoss",

        "seg_loss_name": "DiceCELoss",
        "seg_loss_kwargs": {
            "softmax": true,
            "include_background": true
        },

        "lambda_sig": 0.1,

        "sigloss_kwargs": {
            "bias_init": 0.0,
            "learnable_temperature": true,
            "learnable_bias": true,
            "mode": 2
        }
    },
    "optimizer": {
        "name": "SGD",
        "lr": 0.01,
        "momentum": 0.99,
        "weight_decay": 0.00003,
        "nesterov": true
    },
    "scheduler": {
        "name": "StepLR",
        "step_size": 10,
        "gamma": 0.9
    },
    "metrics": [
        {
            "key": "DSC",
            "name": "DiceMetric",
            "params": { "include_background": false},
            "train": true,
            "val": true,
            "test": true
        },
        {
            "key": "HD95",
            "name": "HausdorffDistanceMetric",
            "params": { "percentile": 95, "include_background": false},
            "train": false,
            "val": true,
            "test": true
        }
    ]
}
